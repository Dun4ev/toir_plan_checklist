# Скрипт `toir_tra_index_works.py`

## 1. Назначение

Скрипт предназначен для сортировки файлов по папкам на основе сложных правил, извлеченных из имен файлов и данных из файла-справочника `TZ.xlsx`.

## 2. Принцип работы

1.  Скрипт сканирует указанную папку со смешанными файлами.
2.  Для каждого файла он пытается извлечь из имени **ключ группировки** (например, `I.7.5-00-1G` или `II.2.6-00-C`).
3.  Все файлы с одинаковым ключом группируются вместе.
4.  Для каждой группы файлов определяется имя целевой папки:
    - Если ключ оканчивается на `-C`, имя папки просто транслитерируется (например, `II.2.6-00-C`).
    - В противном случае, из ключа извлекается **индекс** (`I.7.5`), по которому в `TZ.xlsx` ищется **суффикс** (например, `KBV`). Имя целевой папки формируется как `[ключ]_[суффикс]` (например, `I.7.5-00-1G_KBV`).
5.  Создается целевая папка, и все файлы из группы перемещаются в нее.

## 3. Требования и структура проекта

- **Python**: Версия 3.8 или новее.
- **Библиотеки**: `openpyxl` (`pip install openpyxl`).
- **Структура папок**: Скрипт должен находиться в своей папке, внутри которой есть папка `Template` с файлом-справочником.

  ```
  .../toir_tra_index_works/
  ├── toir_tra_index_works.py  # Сам скрипт
  ├── toir_tra_index_works.md  # Этот файл
  └── Template/
      └── TZ.xlsx              # Файл-справочник с индексами и суффиксами
  ```

## 4. Использование

- Запустите скрипт (`python toir_tra_index_works.py`).
- В появившемся окне выберите папку с файлами, которые нужно отсортировать.
- Дождитесь завершения. Файлы будут рассортированы по новым папкам внутри той же директории.
