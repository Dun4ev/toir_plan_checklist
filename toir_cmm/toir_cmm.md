# Скрипт `toir_cmm.py`

## 1. Назначение

Скрипт предназначен для автоматического создания "Листа комментариев" (Comment Sheet) в формате `.xlsx` для выбранных файлов отчетов (например, `.docx` или `.pdf`).

Он использует шаблон `CommentSheet_Template.xltx` и автоматически заполняет в нем поля на основе имени файла-отчета и данных из справочника `TZ.xlsx`.

## 2. Принцип работы

1.  Пользователь запускает скрипт.
2.  Открывается диалоговое окно для выбора папки.
3.  Пользователь выбирает папку, содержащую файлы отчетов.
4.  Скрипт рекурсивно ищет все файлы `.docx` и `.pdf` в этой папке.
5.  Для каждого найденного файла, имя которого начинается с `CT-DR-`, он:
    - Создает копию из шаблона `CommentSheet_Template.xltx`.
    - Присваивает новому файлу имя вида `[имя_файла_отчета]_CMM.xlsx`.
    - Заполняет поля в новом файле: имя отчета, дата создания.
    - Извлекает из имени файла индекс (например, `I.7.4`), ищет его в `TZ.xlsx` и подставляет найденное описание в соответствующее поле.

## 3. Требования и структура проекта

- **Python**: Версия 3.8 или новее.
- **Библиотеки**: `openpyxl` (`pip install openpyxl`).
- **Структура папок**: Скрипт должен находиться в своей папке, внутри которой есть папка `Template` с необходимыми файлами.

  ```
  .../toir_cmm/
  ├── toir_cmm.py              # Сам скрипт
  ├── toir_cmm.md              # Этот файл
  └── Template/
      ├── TZ.xlsx              # Файл-справочник с индексами
      └── CommentSheet_Template.xltx # Шаблон для листа комментариев
  ```

## 4. Использование

- Запустите скрипт (`python toir_cmm.py`).
- В появившемся окне выберите папку с вашими отчетами.
- Дождитесь завершения обработки. Новые `_CMM.xlsx` файлы появятся рядом с исходными отчетами.